{
    "id":"/istio",
    "apps":[
        {
            "id":"/istio/etcd",
            "acceptedResourceRoles":[
                "*"
            ],
            "backoffFactor":1.15,
            "backoffSeconds":1,
            "cmd":"/usr/local/bin/etcd -advertise-client-urls=http://0.0.0.0:2379 -listen-client-urls=http://0.0.0.0:2379",
            "container":{
                "type":"DOCKER",
                "docker":{
                    "forcePullImage":false,
                    "image":"quay.io/coreos/etcd:latest",
                    "parameters":[

                    ],
                    "privileged":false
                },
                "volumes":[

                ],
                "portMappings":[
                    {
                        "containerPort":2379,
                        "hostPort":31379,
                        "labels":{

                        },
                        "name":"etcd",
                        "protocol":"tcp",
                        "servicePort":10000
                    }
                ]
            },
            "cpus":0.5,
            "disk":0,
            "env":{
                "SERVICE_IGNORE":"1"
            },
            "executor":"",
            "healthChecks":[
                {
                    "gracePeriodSeconds":300,
                    "ignoreHttp1xx":false,
                    "intervalSeconds":60,
                    "maxConsecutiveFailures":3,
                    "path":"/health",
                    "portIndex":0,
                    "protocol":"HTTP",
                    "timeoutSeconds":20,
                    "delaySeconds":15
                }
            ],
            "instances":1,
            "labels":{
                "consul":""
            },
            "maxLaunchDelaySeconds":3600,
            "mem":512,
            "gpus":0,
            "networks":[
                {
                    "mode":"container/bridge"
                }
            ],
            "requirePorts":false,
            "upgradeStrategy":{
                "maximumOverCapacity":1,
                "minimumHealthCapacity":1
            },
            "killSelection":"YOUNGEST_FIRST",
            "unreachableStrategy":{
                "inactiveAfterSeconds":0,
                "expungeAfterSeconds":0
            }
        },
        {
            "id":"/istio/zipkin",
            "cmd":null,
            "cpus":0.5,
            "mem":1024,
            "disk":0,
            "instances":1,
            "portDefinitions":[

            ],
            "acceptedResourceRoles":[
                "slave_public"
            ],
            "container":{
                "type":"DOCKER",
                "docker":{
                    "forcePullImage":false,
                    "image":"jaegertracing/all-in-one:1.5",
                    "parameters":[

                    ],
                    "privileged":false
                },
                "volumes":[

                ],
                "portMappings":[
                    {
                        "containerPort":9411,
                        "hostPort":31767,
                        "labels":{

                        },
                        "name":"zipkin",
                        "protocol":"tcp",
                        "servicePort":10002
                    },
                    {
                        "containerPort":16686,
                        "hostPort":31768,
                        "labels":{

                        },
                        "name":"query-http",
                        "protocol":"tcp",
                        "servicePort":10005
                    },
                    {
                        "containerPort":14267,
                        "hostPort":0,
                        "labels":{

                        },
                        "name":"jaeger-collector-tchannel",
                        "protocol":"tcp",
                        "servicePort":10006
                    },
                    {
                        "containerPort":14268,
                        "hostPort":0,
                        "labels":{

                        },
                        "name":"jaeger-collector-http",
                        "protocol":"tcp",
                        "servicePort":10007
                    },
                    {
                        "containerPort":5775,
                        "hostPort":0,
                        "labels":{

                        },
                        "name":"agent-zipkin-thrift",
                        "protocol":"udp",
                        "servicePort":10008
                    },
                    {
                        "containerPort":6831,
                        "hostPort":0,
                        "labels":{

                        },
                        "name":"agent-compact",
                        "protocol":"tcp",
                        "servicePort":10009
                    },
                    {
                        "containerPort":6832,
                        "hostPort":0,
                        "labels":{

                        },
                        "name":"agent-binary",
                        "protocol":"tcp",
                        "servicePort":10010
                    }
                ]
            },
            "env":{
                "COLLECTOR_ZIPKIN_HTTP_PORT":"9411",
                "MEMORY_MAX_TRACES":"50000"
            },
            "healthChecks":[
                {
                    "gracePeriodSeconds":300,
                    "ignoreHttp1xx":false,
                    "intervalSeconds":60,
                    "maxConsecutiveFailures":3,
                    "path":"/",
                    "portIndex":1,
                    "protocol":"HTTP",
                    "timeoutSeconds":20,
                    "delaySeconds":15
                }
            ],
            "networks":[
                {
                    "mode":"container/bridge"
                }
            ]
        },
        {
            "id":"/istio/apiserver",
            "dependencies":[
                "/istio/etcd"
            ],
            "backoffFactor":1.15,
            "backoffSeconds":1,
            "cmd":"kube-apiserver --etcd-servers http://etcd.istio.marathon.slave.mesos:31379 --service-cluster-ip-range 10.99.0.0/16 --insecure-port 8080 -v 2 --insecure-bind-address 0.0.0.0",
            "container":{
                "type":"DOCKER",
                "docker":{
                    "forcePullImage":false,
                    "image":"gcr.io/google_containers/kube-apiserver:v1.10.12",
                    "parameters":[

                    ],
                    "privileged":false
                },
                "volumes":[

                ],
                "portMappings":[
                    {
                        "containerPort":8080,
                        "hostPort":31080,
                        "labels":{
                            "VIP_0":"/apiserver:8080"
                        },
                        "protocol":"tcp",
                        "servicePort":10000
                    }
                ]
            },
            "cpus":0.3,
            "disk":0,
            "executor":"",
            "healthChecks":[
                {
                    "gracePeriodSeconds":300,
                    "ignoreHttp1xx":false,
                    "intervalSeconds":60,
                    "maxConsecutiveFailures":3,
                    "path":"/healthz",
                    "portIndex":0,
                    "protocol":"HTTP",
                    "timeoutSeconds":20,
                    "delaySeconds":15
                }
            ],
            "instances":1,
            "labels":{
                "HAPROXY_GROUP":"external",
                "HAPROXY_0_VHOST":""
            },
            "maxLaunchDelaySeconds":3600,
            "mem":640,
            "gpus":0,
            "networks":[
                {
                    "mode":"container/bridge"
                }
            ],
            "requirePorts":false,
            "upgradeStrategy":{
                "maximumOverCapacity":1,
                "minimumHealthCapacity":1
            },
            "killSelection":"YOUNGEST_FIRST",
            "unreachableStrategy":{
                "inactiveAfterSeconds":0,
                "expungeAfterSeconds":0
            }
        },
        {
            "id":"/istio/pilot",
            "cmd":"/usr/local/bin/pilot-discovery discovery --httpAddr :15007 --registries Mesos --domain marathon.slave.mesos --marathonURL http://master.mesos:8080 --kubeconfig /mnt/mesos/sandbox/kubeconfig --secureGrpcAddr ''",
            "cpus":1,
            "mem":1024,
            "disk":0,
            "instances":1,
            "dependencies":[
                "/istio/apiserver"
            ],
            "backoffFactor":1.15,
            "backoffSeconds":1,
            "container":{
                "portMappings":[
                    {
                        "containerPort":15007,
                        "hostPort":31507,
                        "protocol":"tcp",
                        "labels":{
                            "VIP_1":"/istio/pilot:15007"
                        },
                        "name":"http"
                    },
                    {
                        "containerPort":15010,
                        "hostPort":31510,
                        "protocol":"tcp",
                        "labels":{
                            "VIP_1":"/istio/pilot:15010"
                        },
                        "name":"grpc"
                    }
                ],
                "type":"DOCKER",
                "volumes":[

                ],
                "docker":{
                    "image":"hyge/pilot:dcos-l4lb",
                    "forcePullImage":false,
                    "parameters":[

                    ]
                }
            },
            "maxLaunchDelaySeconds":3600,
            "networks":[
                {
                    "mode":"container/bridge"
                }
            ],
            "requirePorts":false,
            "upgradeStrategy":{
                "maximumOverCapacity":1,
                "minimumHealthCapacity":1
            },
            "killSelection":"YOUNGEST_FIRST",
            "unreachableStrategy":{
                "inactiveAfterSeconds":0,
                "expungeAfterSeconds":0
            },
            "healthChecks":[
                {
                    "gracePeriodSeconds":300,
                    "ignoreHttp1xx":false,
                    "intervalSeconds":60,
                    "maxConsecutiveFailures":3,
                    "path":"/ready",
                    "portIndex":0,
                    "protocol":"HTTP",
                    "timeoutSeconds":20,
                    "delaySeconds":15
                }
            ],
            "constraints":[

            ],
            "uris":[
                "https://raw.githubusercontent.com/harryge00/mylinuxrc/master/dcos/istio/install/kubeconfig",
                "https://raw.githubusercontent.com/harryge00/mylinuxrc/master/dcos/istio/mesh"
            ]
        }
    ]
}